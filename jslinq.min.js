(function(b,g){var c,d,e,f,a;b.fn=b.prototype;if(b.each===a)b.fn.each=function(c){var b=this,d=b.length,a=0;for(a;a<d;a++)c(b[a],a)};if(b.where===a)b.fn.where=b.fn.all=function(b){var c=this,d=[];if(b===a)return c;c.each(function(a){b(a)===true&&d.push(a)});return d};if(b.select===a)b.fn.select=function(c){var b=this,d=[];if(c===a)return b;b.each(function(a){d.push(c(a))});return d};if(b.take===a)b.fn.take=function(b){var d=this,e=d.length;if(b===a)return d;if(c(b)!=="[Number]")throw"count must be a number";return b>e?d:d.slice(0,b)};if(b.skip===a)b.fn.skip=function(b){var d=this,e=d.length;if(b===a)return d;if(c(b)!=="[Number]")throw"count must be a number";return b>e?d.slice(b-e):d.slice(b)};if(b.first===a||b.single===a)b.fn.first=b.fn.single=function(a){var b=this;return!a?b[0]:b.where(a)[0]};if(b.count===a)b.fn.count=function(b){var c=this;return b===a?this.length:c.where(b).length};if(b.any===a)b.fn.any=function(b){var c=this;return b===a?this.length>0:c.length<=0?false:c.where(b).length>0};if(b.toHash===a||b.toDictionary===a)b.fn.toHash=b.fn.toDictionary=function(c){var b=this,d={};if(c&&b[0][c]===a)throw"key is only valid for arrays of Object";b.each(function(e,a){if(!c)d[a]=b[a];else d[b[a][c]]=b[a]});return d};if(b.orderBy===a||b.order===a)b.fn.orderBy=b.fn.order=function(g){var b=this,h,i;h=g===a?c(b[0]):c(b[0][g]);if(g!==a&&h!=="[Object]"&&b[0][g]===a)throw"cannot use prop with an Array of primitive types (String, Date, Number, Bool)";return g===a?h==="[String]"?b.sort(e):b.sort(d):h==="[String]"?b.sort(f(e,g)):b.sort(f(d,g))};if(b.sum===a)b.fn.sum=function(d){var b=this,e,f=0;e=d===a?c(b[0]):c(b[0][d]);if(e!=="[Number]")throw"array values must be a Number";b.each(function(g,c){var e=d===a?b[c]:b[c][d];f+=e});return f};if(b.average===a||b.mean===a)b.fn.average=b.fn.mean=function(d){var b=this,f=b.length,e;e=d===a?c(b[0]):c(b[0][d]);if(e!=="[Number]")throw"array values must be a Number";return b.sum(d)/f};if(b.max===a)b.fn.max=function(d){var b=this,e,f;e=d===a?c(b[0]):c(b[0][d]);if(e!=="[Number]")throw"array values must be a Number";f=d===a?b:b.select(function(a){return a[d]});return Math.max.apply(Math,f)};if(b.min===a)b.fn.min=function(d){var b=this,e,f;e=d===a?c(b[0]):c(b[0][d]);if(e!=="[Number]")throw"array values must be a Number";f=d===a?b:b.select(function(a){return a[d]});return Math.min.apply(Math,f)};f=function(a,b){return function(c,d){return a(c,d,b)}};c=function(a){return g.prototype.toString.call(a).replace("object ","")};d=function(c,d,b){return b===a?c-d:c[b]-d[b]};e=function(e,f,b){var c,d;c=b===a?e:e[b];d=b===a?f:f[b];return c.localeCompare(d)}})(Array,Object)